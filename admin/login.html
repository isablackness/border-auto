<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Вход в админку</title>
  <link rel="stylesheet" href="/admin/admin.css">
</head>
<body>

<main class="admin-container">
  <h1>Вход в админку</h1>

  <form id="loginForm">
    <input
      type="text"
      id="login"
      placeholder="Логин"
      required
    >

    <input
      type="password"
      id="password"
      placeholder="Пароль"
      required
    >

    <button type="submit">Войти</button>
  </form>
</main>

<script>
  // если уже авторизован — сразу в админку
  if (localStorage.getItem("adminAuth") === "true") {
    location.replace("/admin/");
  }

  document.getElementById("loginForm").onsubmit = async e => {
    e.preventDefault();

    const login = document.getElementById("login").value.trim();
    const password = document.getElementById("password").value;

    const res = await fetch("/api/admin/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ login, password })
    });

    if (res.ok) {
      localStorage.setItem("adminAuth", "true");
      location.replace("/admin/");
    } else {
      alert("Неверный логин или пароль");
    }
  };
</script>

</body>
</html>
